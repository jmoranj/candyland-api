generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --------------------------------------------
// User Table
model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
// --------------------------------------------

// Product Table
model Product {
  id          String         @id @default(cuid())
  name        String
  description String         @db.VarChar(500) // PostgreSQL aceita @db.VarChar
  price       Decimal        @db.Decimal(19, 4)
  category    String
  imageUrl    String
  status      Boolean        @default(true)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt

  // relação com Order
  orderItems  OrderProduct[]
}
// --------------------------------------------

// Categories Table
model Category {
  id        Int      @id @default(autoincrement())
  categoryName      String   @unique
  categoryIcon      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
// --------------------------------------------

// Order Table
enum Status {
  PENDING
  CONFIRMED
  FINISHED
}

model Order {
  id          String         @id @default(cuid())
  name        String
  phone       String
  scheduled   DateTime
  status      Status         @default(PENDING)
  orderedAt   DateTime       @default(now())
  orderPrice  Decimal        @db.Decimal(19, 4)

  orderItems  OrderProduct[]
}

// --------------------------------------------
// Pivot Table
model OrderProduct {
  id                Int      @id @default(autoincrement())
  orderId           String
  productId         String
  quantity          Int
  unitPrice         Decimal  @db.Decimal(19, 4)
  productTotalPrice Decimal  @db.Decimal(19, 4)

  order   Order   @relation(fields: [orderId], references: [id])
  product Product @relation(fields: [productId], references: [id])
}
